# Git Cleanup Branches

## ìƒíƒœ: âœ… êµ¬í˜„ ì™„ë£Œ (2026-02-02)

## ê°œìš”

`~/workspace` í•˜ìœ„ì˜ ëª¨ë“  git repositoryë¥¼ ìŠ¤ìº”í•˜ì—¬, ìµœê·¼ 2ì£¼ì¼ ì´ë‚´ì— commitì´ ë³€ê²½ëœ ë¡œì»¬ ë¸Œëœì¹˜ì˜ PR ë³‘í•© ìƒíƒœë¥¼ ê²€ì‚¬í•˜ê³  stale branchë¥¼ ì •ë¦¬í•˜ëŠ” CLI ë„êµ¬.

## ì‚¬ìš©ë²•

```bash
# dry-run (ê¸°ë³¸) - ì‚­ì œ ëŒ€ìƒë§Œ í™•ì¸
git-cleanup-branches

# ì‹¤ì œ ì‚­ì œ ìˆ˜í–‰
git-cleanup-branches --delete

# ìµœê·¼ 7ì¼ ì´ë‚´ ë³€ê²½ëœ ë¸Œëœì¹˜ë§Œ
git-cleanup-branches --days 7

# í…ŒìŠ¤íŠ¸ìš© ë””ë ‰í† ë¦¬ ì§€ì • (ê¸°ë³¸: ~/workspace)
git-cleanup-branches --workspace /path/to/dir
```

## íŒŒì¼ ìœ„ì¹˜

```
bin/git-cleanup-branches    # Python 3.12 ìŠ¤í¬ë¦½íŠ¸
```

## Stale Branch íŒë‹¨ ê¸°ì¤€

### ê²€ì‚¬ ëŒ€ìƒ

- ìµœê·¼ Nì¼ ì´ë‚´ì— ë§ˆì§€ë§‰ ì»¤ë°‹ì´ ìˆëŠ” ë¸Œëœì¹˜ë§Œ ê²€ì‚¬ (ê¸°ë³¸: 14ì¼)
- ì˜¤ë˜ëœ ë¸Œëœì¹˜ëŠ” ê²€ì‚¬ ëŒ€ìƒì—ì„œ ì œì™¸ (ì‚¬ìš©ìê°€ ë³„ë„ ê´€ë¦¬)

### íŒë‹¨ ê¸°ì¤€

| ì¡°ê±´ | Stale ì—¬ë¶€ |
|------|-----------|
| PRì´ MERGED ìƒíƒœ | âœ… Stale |
| PRì´ CLOSED ìƒíƒœ | âœ… Stale |
| ì›ê²©ì—ì„œ ì‚­ì œ + PR MERGED/CLOSED | âœ… Stale |
| PRì´ OPEN ìƒíƒœ | âŒ ìœ ì§€ |
| PRì´ ì—†ìŒ (ì‘ì—… ì¤‘) | âŒ ìœ ì§€ |

### ë³‘í•© í™•ì¸ ë°©ë²•

- Squash merge ê³ ë ¤í•˜ì—¬ `git cherry -v <base> <branch>` ì‚¬ìš©
- base branch: ê¸°ë³¸ `main`, querypie-monoëŠ” `develop`

## ì²˜ë¦¬ íë¦„

```
1. workspace ë””ë ‰í† ë¦¬ ìŠ¤ìº”
   â””â”€â”€ .git í´ë”ê°€ ìˆëŠ” ë””ë ‰í† ë¦¬ ì°¾ê¸° (1depth)

2. ê° repositoryì— ëŒ€í•´:
   â”œâ”€â”€ git fetch --prune (ì›ê²© ì •ë³´ ì—…ë°ì´íŠ¸)
   â”œâ”€â”€ ë¡œì»¬ ë¸Œëœì¹˜ ëª©ë¡ ì¡°íšŒ (main/develop ì œì™¸)
   â”‚
   â””â”€â”€ ê° ë¸Œëœì¹˜ì— ëŒ€í•´:
       â”œâ”€â”€ ë§ˆì§€ë§‰ ì»¤ë°‹ ë‚ ì§œ í™•ì¸
       â”œâ”€â”€ Nì¼ ì´ë‚´ê°€ ì•„ë‹ˆë©´ â†’ ìŠ¤í‚µ
       â”œâ”€â”€ gh pr listë¡œ PR ìƒíƒœ í™•ì¸
       â”œâ”€â”€ PRì´ MERGED/CLOSED â†’ Staleë¡œ ë§ˆí‚¹
       â””â”€â”€ ì›ê²© ë¸Œëœì¹˜ ì¡´ì¬ ì—¬ë¶€ í™•ì¸

3. ê²°ê³¼ ì¶œë ¥ (í…Œì´ë¸” í˜•ì‹)
   â”œâ”€â”€ Repository ë³„ë¡œ ê·¸ë£¹í•‘
   â””â”€â”€ ë¸Œëœì¹˜ëª…, PR ìƒíƒœ, ë§ˆì§€ë§‰ ì»¤ë°‹ì¼ í‘œì‹œ

4. --delete í”Œë˜ê·¸ ì‹œ
   â””â”€â”€ git branch -Dë¡œ ì‚­ì œ ì‹¤í–‰
```

## ì˜ì¡´ì„±

- Python 3.12+
- `gh` CLI (GitHub CLI) - PR ìƒíƒœ í™•ì¸ìš©
- ì™¸ë¶€ íŒ¨í‚¤ì§€ ì—†ìŒ - Python í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë§Œ ì‚¬ìš©

## ì¶œë ¥ í˜•ì‹

### dry-run (ê¸°ë³¸)

```
Scanning workspace: /Users/jk/workspace
Checking branches with commits in the last 14 days

Found 25 git repositories

ğŸ“ skills-jk-1 (base: main)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Branch               â”‚ PR Status â”‚ Last Commit â”‚ Remote       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ feat/add-feature     â”‚ MERGED    â”‚ 2026-01-28  â”‚ deleted      â”‚
â”‚ fix/bug-123          â”‚ CLOSED    â”‚ 2026-01-30  â”‚ exists       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“ querypie-mono (base: develop)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Branch               â”‚ PR Status â”‚ Last Commit â”‚ Remote       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ feat/new-api         â”‚ MERGED    â”‚ 2026-01-29  â”‚ deleted      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Summary: 3 stale branches found in 2 repositories

Run with --delete to remove these branches.
```

### --delete ì‹¤í–‰ ì‹œ

```
Deleting stale branches...

âœ“ skills-jk-1: feat/add-feature
âœ“ skills-jk-1: fix/bug-123
âœ“ querypie-mono: feat/new-api

Deleted 3 branches.
```

## ì˜ˆì™¸ ì²˜ë¦¬

| ìƒí™© | ì²˜ë¦¬ |
|------|------|
| gh CLI ë¯¸ì„¤ì¹˜ | ì—ëŸ¬ ë©”ì‹œì§€ ì¶œë ¥ í›„ ì¢…ë£Œ |
| gh ì¸ì¦ ì•ˆë¨ | ì—ëŸ¬ ë©”ì‹œì§€ + `gh auth login` ì•ˆë‚´ |
| git repoê°€ ì•„ë‹Œ ë””ë ‰í† ë¦¬ | ìŠ¤í‚µ |
| ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ | í•´ë‹¹ repo ìŠ¤í‚µ + ê²½ê³  ì¶œë ¥ |
| ë¸Œëœì¹˜ ì‚­ì œ ì‹¤íŒ¨ | ì—ëŸ¬ ì¶œë ¥ í›„ ê³„ì† ì§„í–‰ |

## ì£¼ìš” í•¨ìˆ˜ (ì°¸ì¡°)

| í•¨ìˆ˜ | ì—­í•  |
|------|------|
| `find_git_repos(workspace)` | workspace í•˜ìœ„ git repo íƒìƒ‰ |
| `get_local_branches(repo)` | ë¡œì»¬ ë¸Œëœì¹˜ ëª©ë¡ ì¡°íšŒ |
| `get_last_commit_date(repo, branch)` | ë¸Œëœì¹˜ì˜ ë§ˆì§€ë§‰ ì»¤ë°‹ ë‚ ì§œ |
| `get_pr_status(repo, branch)` | gh CLIë¡œ PR ìƒíƒœ í™•ì¸ |
| `get_base_branch(repo)` | repoë³„ base branch ê²°ì • (main/develop) |
| `delete_branch(repo, branch)` | ë¸Œëœì¹˜ ì‚­ì œ ì‹¤í–‰ |
